å€¤ã®èª¿æŸ»

## ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ èªè¨¼å™¨ã®åˆ©ç”¨å¯å¦

window.PublicKeyCredential  
PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable()

PublicKeyCredential ãŒãƒ–ãƒ©ã‚¦ã‚¶ã«å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã™ã‚‹ã‚µãƒ³ãƒ—ãƒ«  
if (\!window.PublicKeyCredential) {  
    console.log("ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§ã¯ WebAuthn ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚");  
    return;  
}

ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ èªè¨¼å™¨ãŒä½¿ãˆã‚‹ã‹ã‚µãƒ³ãƒ—ãƒ«   
const isUVPAA \= await PublicKeyCredential.isUserVerifyingPlatformAuthenticatorAvailable();  
 console.log("isUVPAA:", isUVPAA);

## ãƒ•ã‚©ãƒ¼ãƒ ã‚ªãƒ¼ãƒˆãƒ•ã‚£ãƒ«

PublicKeyCredential.isconditionalMethodationAvailable()

// æ¡ä»¶ä»˜ãUIãŒä½¿ãˆã‚‹ã‹  
        const isCMA \= await PublicKeyCredential.isConditionalMediationAvailable();

## ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆé–¢é€£

challengeå–å¾—æ™‚ã«ã¤ã„ã§ã«å–å¾—ã™ã‚‹ã‚‚ã®

### nvaigator.credentials.createã§å¿…è¦ãªã‚‚ã®

å¼•æ•° {publickey: å¤‰æ•°}  
å¼•æ•°ã«æ¸¡ã™ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ [publicKeyCredentialCreationOptions](https://developer.mozilla.org/en-US/docs/Web/API/PublicKeyCredentialCreationOptions)  
ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰  
å¿…é ˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰

- rpï¼ˆRelying Party æƒ…å ±ï¼‰  
- name: è¡¨ç¤ºåï¼ˆä¾‹: "Example Inc"ï¼‰  
- id: ãƒ‰ãƒ¡ã‚¤ãƒ³åï¼ˆçœç•¥å¯ã€‚çœç•¥æ™‚ã¯ç¾åœ¨ã®ã‚ªãƒªã‚¸ãƒ³ï¼‰  
- userï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ï¼‰  
  - id: ãƒã‚¤ãƒŠãƒªå½¢å¼ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼IDï¼ˆä¾‹: Uint8Arrayï¼‰  
- name: ãƒ¦ãƒ¼ã‚¶ãƒ¼åï¼ˆä¾‹: ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼‰  
- displayName: è¡¨ç¤ºç”¨ãƒ¦ãƒ¼ã‚¶ãƒ¼åï¼ˆä¾‹: ãƒ•ãƒ«ãƒãƒ¼ãƒ ï¼‰


- challenge  
  ã‚µãƒ¼ãƒãƒ¼å´ã§ç”Ÿæˆã—ãŸãƒ©ãƒ³ãƒ€ãƒ ãªãƒã‚¤ãƒˆåˆ—ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–ï¼‰

- pubKeyCredParams  
  å…¬é–‹éµã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’æŒ‡å®šã™ã‚‹é…åˆ—  
  ä¾‹: { type: "public-key", alg: \-7 }ï¼ˆ-7 ã¯ ES256ï¼‰

ğŸ”¶ ä»»æ„ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰

- timeout  
  å‡¦ç†ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã®ãƒŸãƒªç§’æ•°ï¼ˆä¾‹: 60000ï¼‰  
  ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰å€¤ã‚’è¿”ã™  
    
- excludeCredentials  
  ã™ã§ã«ç™»éŒ²æ¸ˆã¿ã® credential ã‚’æŒ‡å®šã—ã¦ã€é‡è¤‡ç™»éŒ²ã‚’é˜²ã  
  å„è¦ç´ : { type: "public-key", id: Uint8Array }  
- authenticatorSelection  
  ä½¿ç”¨ã™ã‚‹èªè¨¼å™¨ã®æ¡ä»¶ã‚’æŒ‡å®šã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ  
- authenticatorAttachment: "platform" or "cross-platform"  
- userVerification: "required", "preferred", "discouraged"  
- residentKey: "required", "preferred", "discouraged"ï¼ˆä»»æ„ï¼‰  
- attestation  
  è¨¼æ˜æ›¸ï¼ˆattestationï¼‰ã®å–å¾—æ–¹å¼  
  "none", "direct", "indirect", "enterprise"  
- extensions  
  WebAuthn æ‹¡å¼µã‚’æŒ‡å®šã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ  
  ä¾‹: { credProps: true }

æœ€å°æ§‹æˆ  
const options \= {  
  rp: { name: "Example Inc" },  
  user: {  
    id: new Uint8Array(16), // ã‚µãƒ¼ãƒãƒ¼ã§ç”Ÿæˆ  
    name: "user@example.com",  
    displayName: "User Example"  
  },  
  challenge: new Uint8Array(32), // ã‚µãƒ¼ãƒãƒ¼ã§ç”Ÿæˆ  
  pubKeyCredParams: \[  
    { type: "public-key", alg: \-7 }  
  \]  
}

#### è¿”ã‚Šå€¤

ä¸»ãªåˆ©ç”¨ã‚·ãƒ¼ãƒ³  
ç™»éŒ²ï¼ˆCreateï¼‰  
navigator.credentials.create() ã§ç”Ÿæˆã•ã‚Œã‚‹ã€‚

èªè¨¼ï¼ˆGetï¼‰  
navigator.credentials.get() ã§å–å¾—ã•ã‚Œã‚‹ã€‚

PublicKeyCredential  
PublicKeyCredential {  
  id: string,  
  rawId: ArrayBuffer,  
  response : AuthenticatorAttestationResponse {  
    clientDataJSON: ArrayBuffer ,  
    attestationObject: ArrayBuffer  
  },  
  authenticatorAttachment: String,  
  type: string  
}

â€»  
ArrayBufferã¯Base64URL æ–‡å­—åˆ—ãªã©ã«å¤‰æ›ã—ã¦é€ä¿¡ã™ã‚‹ã®ãŒä¸€èˆ¬  
ArrayBuffer ã¯ ãƒã‚¤ãƒŠãƒªãƒ‡ãƒ¼ã‚¿  
HTTP ã‚„ JSON ã¯ æ–‡å­—åˆ—ãƒ™ãƒ¼ã‚¹ãªã®ã§ã€ArrayBuffer ã¯ãã®ã¾ã¾ã§ã¯é€ã‚Œãªã„  
ç™»éŒ²å®Œäº†æ™‚ã«é€ä¿¡ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‚‚ã®

ã‚µãƒ¼ãƒãƒ¼å´ã§ä¿å­˜ã™ã¹ãæƒ…å ±